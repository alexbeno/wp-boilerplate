(function(root,factory){if(typeof define==='function'&&define.amd){define(['pxloader'],function(PxLoader){return(root.PxLoaderImage=factory(PxLoader));});}else if(typeof module==='object'&&module.exports){module.exports=factory(require('pxloader'));}else{root.PxLoaderImage=factory(root.PxLoader);}}(this,function(PxLoader){function PxLoaderImage(url,tags,priority,options){options=options||{};var self=this,loader=null,img;img=this.img=new Image();if(options.origin){img.crossOrigin=options.origin;}this.tags=tags;this.priority=priority;var onReadyStateChange=function(){if(self.img.readyState!=='complete'){return;}onLoad();};var onLoad=function(){loader.onLoad(self);cleanup();};var onError=function(){loader.onError(self);cleanup();};var onTimeout=function(){loader.onTimeout(self);cleanup();};var cleanup=function(){self.unbind('load',onLoad);self.unbind('readystatechange',onReadyStateChange);self.unbind('error',onError);};this.start=function(pxLoader){loader=pxLoader;self.bind('load',onLoad);self.bind('readystatechange',onReadyStateChange);self.bind('error',onError);self.img.src=url;};this.checkStatus=function(){onReadyStateChange();};this.onTimeout=function(){if(self.img.complete){onLoad();}else{onTimeout();}};this.getName=function(){return url;};this.bind=function(eventName,eventHandler){self.img.addEventListener(eventName,eventHandler,false);};this.unbind=function(eventName,eventHandler){self.img.removeEventListener(eventName,eventHandler,false);};}PxLoader.prototype.addImage=function(url,tags,priority,options){var imageLoader=new PxLoaderImage(url,tags,priority,options);this.add(imageLoader);return imageLoader.img;};return PxLoaderImage;}));